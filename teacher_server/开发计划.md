# 茶文化课程APP - 教师端服务器开发计划

## 项目概述
开发一个Python Web服务器，用于接收学生APP提交的数据，存储到数据库中，并提供Web界面供教师查看学生提交的内容。

## 技术栈
- **后端框架**：Flask（轻量级，易于开发）或 FastAPI（现代化，性能好）
- **数据库**：SQLite（开发阶段）或 PostgreSQL（生产环境）
- **ORM**：SQLAlchemy（数据库操作和迁移）
- **前端**：HTML + CSS + JavaScript（响应式设计，适配平板）
- **文件存储**：本地文件系统（照片存储）

## 项目结构
```
teacher_server/
├── app/
│   ├── __init__.py              # Flask应用初始化
│   ├── models.py                # 数据库模型（SQLAlchemy）
│   ├── database.py              # 数据库配置和初始化
│   ├── routes/
│   │   ├── __init__.py
│   │   ├── api.py               # API路由（接收学生数据）
│   │   └── web.py               # Web路由（教师查看界面）
│   ├── services/
│   │   ├── __init__.py
│   │   ├── data_service.py      # 数据处理服务
│   │   └── photo_service.py     # 照片处理服务
│   ├── utils/
│   │   ├── __init__.py
│   │   ├── validators.py        # 数据验证
│   │   └── helpers.py           # 辅助函数
│   └── templates/               # HTML模板
│       ├── base.html
│       ├── index.html           # 学生列表页
│       ├── student_detail.html  # 学生详情页
│       └── components/          # 组件模板
├── static/                      # 静态文件
│   ├── css/
│   ├── js/
│   └── images/
├── uploads/                     # 照片上传目录
│   └── photos/
├── migrations/                  # 数据库迁移脚本
├── config.py                    # 配置文件
├── requirements.txt             # Python依赖
├── run.py                       # 启动脚本
├── README.md                    # 项目说明
└── 数据库设计方案.md            # 数据库设计文档
```

## 开发步骤

### 第一阶段：项目基础搭建（1-2天）

#### 1.1 环境准备
- [ ] 创建项目目录结构
- [ ] 初始化Python虚拟环境
- [ ] 安装依赖包（Flask, SQLAlchemy, 等）
- [ ] 创建requirements.txt

#### 1.2 配置文件
- [ ] 创建config.py（数据库配置、上传路径等）
- [ ] 支持开发/生产环境配置切换
- [ ] 配置日志系统

#### 1.3 数据库初始化
- [ ] 创建database.py（数据库连接和初始化）
- [ ] 创建models.py（定义所有数据模型）
- [ ] 创建数据库迁移脚本
- [ ] 初始化数据库表结构

### 第二阶段：API接口开发（2-3天）

#### 2.1 数据接收API
- [ ] 创建/api/submit接口（接收学生提交数据）
- [ ] 数据验证和清洗
- [ ] 生成唯一提交ID
- [ ] 保存学生基本信息到student_groups表
- [ ] 保存小组成员到group_members表

#### 2.2 任务数据保存
- [ ] 保存任务一数据到task1_data表
- [ ] 保存任务二数据到task2_data表
- [ ] 保存思考题数据到thinking_questions表
- [ ] JSON字段数据序列化和存储

#### 2.3 照片处理
- [ ] 创建照片上传服务（photo_service.py）
- [ ] Base64解码照片数据
- [ ] 保存照片文件到uploads/photos目录
- [ ] 生成唯一文件名
- [ ] 保存照片信息到photos表
- [ ] 照片文件大小验证

#### 2.4 API响应和错误处理
- [ ] 返回标准JSON响应格式
- [ ] 错误处理和异常捕获
- [ ] 日志记录

### 第三阶段：Web界面开发（3-4天）

#### 3.1 学生列表页面
- [ ] 创建index.html（学生列表）
- [ ] 显示学生组信息（学校、年级、班级、日期）
- [ ] 分页功能
- [ ] 筛选功能（按学校、年级、班级、日期）
- [ ] 搜索功能
- [ ] 响应式设计（适配平板）

#### 3.2 学生详情页面
- [ ] 创建student_detail.html
- [ ] 显示学生基本信息
- [ ] 显示小组成员列表
- [ ] 显示任务一完整数据（包括表格）
- [ ] 显示任务二完整数据
- [ ] 显示思考题答案
- [ ] 显示创意题答案
- [ ] 照片展示（图片轮播/网格）

#### 3.3 数据展示组件
- [ ] 表格组件（任务一的感官记录表格）
- [ ] 照片查看器（支持放大、切换）
- [ ] 文本内容展示（支持长文本换行）
- [ ] 时间格式化显示

#### 3.4 样式设计
- [ ] 创建基础CSS样式
- [ ] 平板适配样式（横屏优化）
- [ ] 卡片式布局
- [ ] 颜色主题（与APP保持一致）

### 第四阶段：功能完善（2-3天）

#### 4.1 数据查询优化
- [ ] 数据库查询优化（索引使用）
- [ ] 分页查询优化
- [ ] 缓存机制（可选）

#### 4.2 数据导出功能
- [ ] 导出单个学生数据为PDF
- [ ] 导出所有学生数据为Excel
- [ ] 批量导出照片

#### 4.3 统计功能
- [ ] 按学校/年级/班级统计提交数量
- [ ] 提交时间统计图表
- [ ] 数据完整性统计

#### 4.4 安全性
- [ ] API接口限流
- [ ] 文件上传大小限制
- [ ] 数据验证和过滤
- [ ] 错误信息不泄露敏感信息

### 第五阶段：测试和优化（2-3天）

#### 5.1 功能测试
- [ ] API接口测试
- [ ] Web界面测试
- [ ] 数据完整性测试
- [ ] 照片上传和显示测试

#### 5.2 性能测试
- [ ] 并发请求测试
- [ ] 大量数据查询测试
- [ ] 照片加载性能优化

#### 5.3 兼容性测试
- [ ] 不同浏览器测试
- [ ] 平板设备测试
- [ ] 不同屏幕尺寸测试

#### 5.4 文档编写
- [ ] API文档
- [ ] 部署文档
- [ ] 使用说明

### 第六阶段：部署和上线（1-2天）

#### 6.1 部署准备
- [ ] 生产环境配置
- [ ] 数据库迁移到PostgreSQL（如需要）
- [ ] 静态文件配置
- [ ] 日志配置

#### 6.2 服务器部署
- [ ] 安装依赖
- [ ] 配置Web服务器（Nginx + Gunicorn）
- [ ] 配置数据库
- [ ] 配置文件存储路径

#### 6.3 监控和维护
- [ ] 日志监控
- [ ] 错误监控
- [ ] 性能监控
- [ ] 备份策略实施

## 关键技术点

### 1. 数据库设计
- 使用关系型数据库，规范化设计
- JSON字段存储灵活数据
- 版本控制字段支持数据结构变更

### 2. API设计
- RESTful API设计
- 统一响应格式
- 错误处理机制

### 3. 照片处理
- Base64解码
- 文件存储管理
- 文件路径管理

### 4. 前端设计
- 响应式布局
- 平板横屏优化
- 图片懒加载
- 数据分页

### 5. 扩展性
- 模块化设计
- 配置化管理
- 版本控制
- 数据迁移机制

## 开发时间估算

- **第一阶段**：1-2天
- **第二阶段**：2-3天
- **第三阶段**：3-4天
- **第四阶段**：2-3天
- **第五阶段**：2-3天
- **第六阶段**：1-2天

**总计**：11-17天（约2-3周）

## 后续优化方向

1. **实时更新**：使用WebSocket实现数据实时推送
2. **数据分析**：添加数据分析和可视化功能
3. **用户权限**：添加教师登录和权限管理
4. **数据备份**：自动备份和恢复功能
5. **移动端优化**：进一步优化移动端体验
6. **多语言支持**：支持多语言界面

## 注意事项

1. **数据安全**：确保学生数据安全，防止泄露
2. **性能优化**：大量照片和数据的加载性能
3. **兼容性**：确保在不同设备和浏览器上正常工作
4. **可维护性**：代码结构清晰，便于后续维护和扩展
5. **文档完善**：保持文档与代码同步更新

