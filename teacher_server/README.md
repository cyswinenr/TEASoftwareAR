# 茶文化课程APP - 教师端服务器

## 项目简介

这是一个Python Web服务器系统，用于接收学生APP提交的茶文化课程数据，存储到数据库中，并提供Web界面供教师查看和管理学生提交的内容。

## 核心功能

1. **数据接收**：接收学生APP通过HTTP POST提交的数据
2. **数据存储**：将数据存储到关系型数据库中
3. **照片管理**：处理和管理学生提交的照片
4. **数据查看**：提供Web界面供教师查看学生数据
5. **数据导出**：支持导出学生数据为PDF/Excel格式

## 技术架构

- **后端框架**：Flask / FastAPI
- **数据库**：SQLite（开发） / PostgreSQL（生产）
- **ORM**：SQLAlchemy
- **前端**：HTML + CSS + JavaScript（响应式设计）

## 数据库设计特点

### 1. 规范化设计
- 使用关系型数据库，减少数据冗余
- 主表（student_groups）关联多个子表
- 外键约束保证数据完整性

### 2. 可扩展性
- **JSON字段**：使用JSON存储灵活数据（如感官记录表格）
- **版本控制**：每个表都有version字段，支持数据结构变更
- **预留字段**：extra_data字段用于存储未来可能添加的数据

### 3. 照片分离存储
- 照片文件存储在文件系统中
- 数据库只存储文件路径和元数据
- 便于照片管理和备份

### 4. 索引优化
- 为常用查询字段创建索引
- 提高查询性能

## 数据库表结构

### 核心表
1. **student_groups** - 学生组基本信息
2. **group_members** - 小组成员信息
3. **task1_data** - 任务一数据
4. **task2_data** - 任务二数据
5. **thinking_questions** - 思考题数据
6. **photos** - 照片信息

详细设计请参考：[数据库设计方案.md](./数据库设计方案.md)

## 开发计划

项目分为6个阶段，预计2-3周完成：

1. **项目基础搭建**（1-2天）
2. **API接口开发**（2-3天）
3. **Web界面开发**（3-4天）
4. **功能完善**（2-3天）
5. **测试和优化**（2-3天）
6. **部署和上线**（1-2天）

详细计划请参考：[开发计划.md](./开发计划.md)

## 项目结构

```
teacher_server/
├── app/                    # 应用主目录
│   ├── models.py          # 数据库模型
│   ├── routes/             # 路由
│   ├── services/          # 业务逻辑
│   └── templates/         # HTML模板
├── static/                 # 静态文件
├── uploads/               # 上传文件
├── migrations/            # 数据库迁移
└── config.py              # 配置文件
```

## 快速开始

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 配置数据库
编辑 `config.py`，配置数据库连接信息

### 3. 初始化数据库
```bash
python init_db.py
```

### 4. 启动服务器
```bash
python run.py
```

### 5. 访问Web界面
打开浏览器访问：`http://localhost:8888`

## API接口

### 提交学生数据
```
POST /api/submit
Content-Type: application/json

{
    "studentInfo": {...},
    "task1": {...},
    "task2": {...},
    "thinking1": {...},
    "thinking2": {...},
    "creative": {...}
}
```

### 获取学生列表
```
GET /api/students?page=1&limit=20&school=xxx&grade=xxx
```

### 获取学生详情
```
GET /api/students/{submission_id}
```

## 数据扩展性

### 如何添加新字段

1. **简单字段**：直接在对应表中添加列
2. **复杂数据**：使用JSON字段存储
3. **新表**：创建新表并关联到student_groups

### 版本升级流程

1. 创建迁移脚本
2. 更新数据库模型
3. 更新version字段
4. 测试数据兼容性

## 安全考虑

1. **API限流**：防止恶意请求
2. **文件验证**：验证上传文件类型和大小
3. **数据验证**：验证提交数据的合法性
4. **错误处理**：不泄露敏感信息

## 性能优化

1. **数据库索引**：为常用查询字段创建索引
2. **分页查询**：避免一次性加载大量数据
3. **图片优化**：图片压缩和懒加载
4. **缓存机制**：缓存常用查询结果

## 维护和扩展

### 日常维护
- 定期备份数据库
- 清理过期照片文件
- 监控服务器性能

### 功能扩展
- 添加数据分析功能
- 实现实时数据推送
- 添加用户权限管理
- 支持多语言

## 许可证

本项目仅供教育使用

## 联系方式

如有问题或建议，请联系开发团队

