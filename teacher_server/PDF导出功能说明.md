# PDF导出功能使用说明 📄

## 🎯 功能介绍

教师端新增了**PDF报告导出**功能，可以为每个小组生成精美的PDF学习报告，方便：
- 📁 **教学留档**：保存学生完整学习记录
- 🏆 **成果展示**：展示教学成果
- 📊 **家长沟通**：发给家长查看学习情况
- 📚 **档案管理**：统一格式，易于归档

---

## 📦 安装依赖

### 方法1：使用批处理文件（推荐）
双击运行：`安装导出依赖.bat`

### 方法2：手动安装
```bash
pip install reportlab==4.0.7
```

---

## 📄 PDF报告内容

每个小组的PDF报告包含以下完整内容：

### 1️⃣ 封面标题
- **茶文化课程学习报告**（居中大标题）

### 2️⃣ 学生基本信息
- 小组编号、学校、年级、班级
- 活动日期、成员人数
- 提交时间
- 小组成员名单

### 3️⃣ 任务一：泡茶体验、品茶时刻
- 茶品信息表格
- 感官记录表格（干茶、茶汤、叶底）
- 思考题答案

### 4️⃣ 任务二：泡出你心中的那杯茶
- 冲泡参数和茶汤特点
- 是否符合预期
- 思考题答案

### 5️⃣ 思考题一、二、创意题
- 完整答案内容

### 6️⃣ 茶助教问答记录
- 统计信息（学生提问次数、AI回答次数）
- 完整对话记录（前10轮）
- 学生和AI的对话用不同颜色区分

### 7️⃣ 页脚信息
- 生成时间戳

---

## 🚀 使用方法

### 方式1：在学生详情页导出

1. **登录教师端** → 打开浏览器访问服务器地址
2. **进入学生列表** → 点击任意学生的"查看详情"
3. **导出PDF** → 点击橙色按钮"📄 导出PDF报告"
4. **下载文件** → 浏览器自动下载PDF文件

### 方式2：直接访问URL（高级用法）
```
http://服务器地址/export/pdf/学生提交ID
```

---

## 📝 文件命名规则

PDF文件自动命名为：
```
茶文化课程报告_学校名_年级班级_小组编号.pdf
```

**示例：**
```
茶文化课程报告_示例中学_高二5班_小组3.pdf
```

---

## 🎨 PDF报告样式

### 配色方案
- **主色调**：绿色系（#2E7D32）- 体现茶文化主题
- **学生对话**：浅绿色背景（#E8F5E9）
- **AI对话**：浅紫色背景（#F3E5F5）
- **表格表头**：绿色背景白色文字

### 排版特点
- ✅ A4页面大小，标准打印尺寸
- ✅ 2cm页边距，适合装订
- ✅ 清晰的层级结构
- ✅ 精美的表格样式
- ✅ 合理的间距和留白
- ✅ 支持中文显示

---

## 💡 应用场景

### 1. 教学档案管理
每个学期结束后，为所有小组生成PDF报告，统一归档保存。

### 2. 教学成果展示
- 在家长会上展示优秀小组的报告
- 作为教学示范材料
- 教育局检查时的成果展示

### 3. 学生作品集
发给学生家长，让家长了解孩子的学习成果。

### 4. 教研交流
与其他学校分享教学案例和学生作品。

---

## ⚙️ 技术细节

### 支持的中文字体
系统会自动尝试使用以下字体：
- Windows: 黑体、宋体、微软雅黑
- macOS: PingFang
- Linux: 文泉驿正黑

### 对话记录限制
为避免PDF文件过大，对话记录默认只显示前10轮。如需查看完整对话，请使用Excel或JSON导出。

### 照片支持
当前版本PDF报告中**不包含照片**（照片会增大文件体积）。如需查看照片，请在Web详情页面查看，或使用Excel导出。

---

## 🔧 故障排除

### Q1: 点击导出PDF按钮没有反应？
**A:** 
1. 检查是否安装了reportlab：`pip list | grep reportlab`
2. 查看服务器日志是否有错误信息
3. 尝试重启服务器

### Q2: PDF文件打不开？
**A:**
1. 确认PDF阅读器已安装（Adobe Reader、Foxit等）
2. 检查文件是否完整下载（查看文件大小，通常应该>100KB）
3. 尝试用不同的PDF阅读器打开

### Q3: PDF中中文显示为方框？
**A:**
1. Windows系统：确认系统字体文件夹有simhei.ttf或msyh.ttc
2. 如果仍有问题，请查看服务器日志中的字体注册信息
3. 可以手动指定字体路径（修改pdf_service.py中的font_paths）

### Q4: PDF生成很慢？
**A:**
1. 正常情况下生成时间<5秒
2. 如果学生提问很多（>20条），可能需要更长时间
3. 对话记录只显示前10轮，避免文件过大

### Q5: 想批量导出所有小组的PDF怎么办？
**A:**
目前需要逐个导出。如需批量导出，可以：
1. 使用Excel导出功能（包含所有小组数据）
2. 联系技术支持添加批量PDF导出功能

---

## 📊 与其他导出格式对比

| 功能 | PDF | Excel | JSON |
|------|-----|-------|------|
| **适合场景** | 留档、展示 | 统计分析 | AI分析 |
| **人类可读性** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐ |
| **打印效果** | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐ |
| **编辑修改** | ⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐ |
| **统计分析** | ⭐⭐ | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ |
| **文件大小** | 中等 | 小 | 小 |
| **包含照片** | ❌ | ❌ | ❌ |

---

## 💡 使用建议

### 推荐导出策略
1. **日常使用** → Web页面在线查看
2. **数据分析** → 导出Excel
3. **教学留档** → 导出PDF（每学期结束）
4. **AI分析** → 导出JSON

### 文件管理
建议按以下方式组织PDF文件：
```
茶文化课程档案/
├── 2024学年第一学期/
│   ├── 高一/
│   │   ├── 1班/
│   │   │   ├── 小组1.pdf
│   │   │   ├── 小组2.pdf
│   │   │   └── ...
│   │   └── 2班/
│   └── 高二/
└── 2024学年第二学期/
```

---

## 📞 技术支持

如有其他问题，请联系技术支持团队。

**祝使用愉快！** 🎉

